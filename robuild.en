<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
        "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>NetSurf | Building NetSurf on RISC OS</title>
<link rel="stylesheet" type="text/css" href="netsurf.css">
</head>

<body>
<p class="banner"><a href="/"><img src="netsurf.png" alt="NetSurf: Web Browser for RISC OS"></a></p>

<h1>Building NetSurf on RISC OS</h1>

<ul>
<li><a href="#Overview">Overview</a></li>
<li><a href="#Requirements">Requirements</a></li>
<li><a href="#UnpackingTheLibraries">Unpacking the Libraries</a></li>
<li><a href="#AcquiringAndCompilingTheSource">Acquiring and Compiling the source</a></li>
<li><a href="#NotesOnAutogeneratedFiles">Notes on Autogenerated Files</a></li>
</ul>

<p class="updated">Last updated 18th February 2005</p>

<h2 id="Overview">Overview</h2>

<p>This document outlines the process required to get a build system for NetSurf set up on a RISC OS machine.  Much of what is discussed should be fairly obvious already, but it's worth being comprehensive.</p>

<h2 id="Requirements">Requirements</h2>

<ul>
<li>A Filing System which supports long filenames</li>
<li>!GCC (<a href="http://gccsdk.riscos.info/">http://gccsdk.riscos.info/</a>)</li>
<li>Prebuilt libraries and sources (<a href="http://netsurf.strcprstskrzkrk.co.uk/developer">http://netsurf.strcprstskrzkrk.co.uk/developer</a>)</li>
<li>RISC OS CVS client (<a href="http://cvs.riscos.org.uk/">http://cvs.riscos.org.uk/</a>)</li>
</ul>

<h2 id="UnpackingTheLibraries">Unpacking the Libraries</h2>

<ol>
<li>Create a directory named NSLibs in the location where you wish to install the libraries</li>
<li>Into this directory, unpack the library zip files available from the URL above). This should give you a directory tree which looks like this:

<div><object data="images/library1.png" type="image/png"><pre>   NSLibs
      |
      | -- include
      |       |
      |       | -- curl
      |       | -- libjpeg
      |       | -- libpng
      |       | -- libxml
      |       | -- openssl
      | -- lib</pre></object></div>
</li>

<li>Use a utility such as !Rename to rename the header files into RISC OS format (i.e. <code>foo/h</code> becomes <code>h.foo</code>). This should produce a directory tree like:

<div><object data="images/library2.png" type="image/png"><pre>    NSLibs
      |
      | -- include
      |       |
      |       | -- curl
      |       |     |
      |       |     | -- h
      |       |
      |       | -- h
      |       |
      |       | -- libjpeg
      |       |      |
      |       |      | -- h
      |       |
      |       | -- libxml
      |       |      |
      |       |      | -- h
      |       |
      |       | -- openssl
      |       |      |
      |       |      | -- h
      |
      | -- lib</pre></object></div>

with the headers in the &quot;h&quot; directories. [This step may not be required, depending upon the naming format used for the pre-built libraries]
</li>
<li>Remove the filename extensions from the files in the lib directory 
   (e.g. <code>libxml2/a</code> becomes <code>libxml2</code>)</li>
<li>Create an Obey file with the following inside:
<pre>Set NSLibs$Path &lt;Obey$Dir&gt;.</pre>
(noting the trailing '.') and save it as <code>NSLibs.SetPath</code></li>
<li>Run SetPath to set the path variable up</li>
<li>Install OSLib as documented in its instructions and run it</li>
</ol>

<h2 id="AcquiringAndCompilingTheSource">Acquiring and Compiling the source</h2>

<ol>
<li>Use the RISC OS CVS client to check the source out from CVS, using the following sequence of commands:

<pre>cvs -d:pserver:anonymous@semichrome.net:/home/netsurf/cvs login</pre>
(just press return when prompted for a password)
<pre>cvs -z3 -d:pserver:anoncvs@semichrome.net:/home/netsurf/cvs co netsurf</pre>

This will check the latest sources out into a subfolder in the currently selected directory (CSD) entitled &quot;netsurf&quot;. This folder is the root of the source tree. Diagrammatically:
   
<div><object data="images/netsurftree1.png" type="image/png"><pre>     netsurf
       |
       | -- !NCNetSurf
       | -- !NetSurf
       | -- content
       | -- css
       | -- debug
       | -- desktop
       | -- gtk
       | -- Docs
       | -- image
       | -- render
       | -- riscos
       | -- utils</pre></object></div>
       
Alternatively, use the RISC OS CVS GUI.  Create a new project and enter the details:
<dl><dt>Transport</dt><dd>pserver</dd>
<dt>Username</dt><dd>anonymous</dd>
<dt>Hostname</dt><dd>semichrome.net</dd>
<dt>Password</dt><dd>(leave blank)</dd>
<dt>Port</dt><dd>2401</dd>
<dt>CVSRoot Dir</dt><dd>/home/netsurf/cvs</dd>
<dt>Repository</dt><dd>netsurf</dd>
<dt>Local Dir</dt><dd>(choose a location on your local disc)</dd>
</dl>
   
In the Options dialog box, ensure <em>Add &quot;,xyz&quot; suffix</em> is not checked, and enter <code>a:c:cc:f:h:i:ii:l:o:p:s:y</code> in the text field.
</li>

<li>Modify the file <code>makefile</code> in the sources as follows:
<pre>depend: */*.[ch]</pre>
should be changed to
<pre>depend:</pre>
</li>

<li>Take the pre-built sources and insert them into the <code>css</code> directory in the source tree, taking care to rename appropriately for RISC OS:
   
<table style="font-family: monospace">
<tbody>
<tr><td>css_enum/c</td><td>&nbsp;&gt;&nbsp;</td><td>css.c.css_enum</td></tr>
<tr><td>css_enum/h</td><td>&nbsp;&gt;&nbsp;</td><td>css.h.css_enum</td></tr>
<tr><td>parser/c</td><td>&nbsp;&gt;&nbsp;</td><td>css.c.parser</td></tr>
<tr><td>parser/h</td><td>&nbsp;&gt;&nbsp;</td><td>css.h.parser</td></tr>
<tr><td>scanner/c</td><td>&nbsp;&gt;&nbsp;</td><td>css.c.scanner</td></tr>
</tbody>
</table>
</li>

<li>Insert transtab/c into utils, renaming as per the css files above.</li>
<li>Create an <code>arm-riscos-aof</code> directory at the root of the NetSurf source tree. This is where the compiled object files will end up. The source tree should now look like this:
<div><object data="images/netsurftree2.png" type="image/png"><pre>     netsurf
       |
       | -- !NCNetSurf
       | -- !NetSurf
       | -- arm-riscos-aof
       | -- content
       | -- css
       | -- debug
       | -- desktop
       | -- gtk
       | -- Docs
       | -- image
       | -- render
       | -- riscos
       | -- utils</pre></object></div>
</li>
<li>Set the netsurf directory as your CSD and invoke <code>make</code> from a TaskWindow</li>
<li>Go and make a cup of tea whilst the build happens (it takes approximately 30 minutes on a StrongARM RiscPC)</li>
</ol>

<h2 id="NotesOnAutogeneratedFiles">Notes on Autogenerated Files</h2>

<p>The NetSurf build process on Unix creates a number of source files automatically. This is not possible under RISC OS and so we provide pre-built versions of these alongside the pre-built libraries. You will need to ensure that your local copies of these are up to date, as build problems may occur otherwise. Simply checking the CVS log on the download page regularly should inform you of changes to the source for these autogenerated files.</p>

<div class="footer">
<p class="breadcrumbs"><a href="/">NetSurf</a> » <a href="develop"> Development Information</a> » Building NetSurf on RISC OS</p>
<p class="sourceforge"><a href="http://sourceforge.net/"><img src="http://sourceforge.net/sflogo.php?group_id=51719&amp;type=1" alt="SourceForge.net"></a></p>
</div>

</body>
</html>
